<section class="login shadow rounded border">
    <h1>Réinitialiser le mot de passe</h1>

    <ng-container *ngIf="!token(); else ready">
        <p class="hint">Lien invalide : token manquant.</p>
        <p class="tiny"><a routerLink="/auth/forgot-password">Redemander un lien</a></p>
    </ng-container>

    <ng-template #ready>
        <form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>
            <label class="field">
                <span>Nouveau mot de passe</span>
                <input type="password" autocomplete="new-password" formControlName="password" placeholder="••••••••" />
            </label>

            <label class="field">
                <span>Confirmer</span>
                <input type="password" autocomplete="new-password" formControlName="confirm"
                    [class.invalid]="showConfirmMismatch" placeholder="••••••••" />
                <small *ngIf="showConfirmMismatch">Les mots de passe ne correspondent pas.</small>
            </label>

            <button class="btn" type="submit" [disabled]="pending() || form.invalid">{{ pending() ? 'Mise à jour…' :
                'Changer le mot de passe' }}</button>

            <p class="hint ok" *ngIf="okMsg()">{{ okMsg() }}</p>
            <p class="hint" *ngIf="errMsg()">{{ errMsg() }}</p>
        </form>
    </ng-template>

    <p class="tiny" style="margin-top:10px;"><a routerLink="/login">Retour à la connexion</a></p>
</section>